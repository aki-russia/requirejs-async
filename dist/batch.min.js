window.batch=new function(){var a,b,c,d,e,f,g,h;return g=function(a){return"function"==typeof a},f=Array.isArray||function(a){return"[object Array]"===toString.call(a)},h=function(a){return a===Object(a)},d=Object.keys||function(a){var b,c,d,e;if(!h(a))throw new TypeError("Invalid object");for(c=[],d=0,e=a.length;e>d;d++)b=a[d],a.hasOwnProperty(b)&&(c[c.length]=b);return c},a=function(a){return this._start_time=+new Date,this._limit=a||50},a.prototype={start:function(a){var b;return b=+new Date,this._limit<b-this._start_time?(this._start_time=b,setTimeout(a,0)):a()}},e={call_complete_handlers:function(a,b,c){var d;return 0<a.length?(d=a.shift(),d(b),c.start(function(){return e.call_complete_handlers(a,b,c)})):void 0}},c=function(b,c,i){var j,k,l,m,n,o,p;return o=void 0,n=null,j=c||new a,p={is_complete:!1},k=[],g(i)&&k.push(i),m=function(){return p.result||(p.result=p.data),e.call_complete_handlers(k,p,j)},l=g(b)?function(){var a,c;return p.is_wait?!1:0===o.length||p.is_complete?(p.is_complete=!0,m(),p):(a=o.shift(),c=b(p.data[a],a,n),void 0!==c&&(p.result||(p.result=f(p.data)?[]:{}),p.result[a]=c),j.start(l))}:function(){return p.is_complete=!0,p.result=p.data,m(),p},n=function(a){return p.data=a,o=f(a)||h(a)?d(p.data):[],j.start(l)},n.iterator=b,n.complete=function(a){return k.push(a),p.is_complete?m():void 0},n.stop=function(){return p.is_complete=!0},n.pause=function(){return p.is_wait=!0},n.resume=function(){return p.is_wait=!1,null!=j?j.start(l):void 0},n.state=p,n},b=function(b){return this._last_iteration=c(),this._last_iteration(b||[]),this._balancer=new a,this},b.prototype={_push:function(a){var b;return b=c(a.iterator,this._balancer,a.complete),this._last_iteration.complete(function(a){return b(a.result)}),this._last_iteration=b,this},stop:function(){return this._last_iteration.stop(),this},use:function(a){return this._push({complete:function(b){return b.result=a}}),this},each:function(a){return this._push({iterator:function(b,c,d){return a(b,c,d)===!1?this.stop():void 0}}),this},map:function(a){return this._push({iterator:a})},reduce:function(a){var b;return b=void 0,this._push({iterator:function(c,d,e){return b=a(c,d,b,e)},complete:function(a){return a.result=b}}),this},find:function(a){var b;return b=void 0,this._push({iterator:function(c,d,e){return a(c,d,e)?b=c:void 0},complete:function(a){return a.result=b}}),this},next:function(a){return this._push({complete:function(b){var c;return c=a(b.result),b.result=void 0!==c?c:b.data}}),this}},function(a){return new b(a)}};